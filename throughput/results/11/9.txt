BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%pink%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 261701778.432123
 ALGERIA                   |   1997 | 453890128.230272
 ALGERIA                   |   1996 | 457507601.400225
 ALGERIA                   |   1995 | 457886650.415253
 ALGERIA                   |   1994 | 454375133.568318
 ALGERIA                   |   1993 |  449442350.65143
 ALGERIA                   |   1992 | 454956727.106013
 ARGENTINA                 |   1998 | 282237253.803918
 ARGENTINA                 |   1997 | 476565941.926316
 ARGENTINA                 |   1996 | 483786165.384451
 ARGENTINA                 |   1995 | 472898786.872432
 ARGENTINA                 |   1994 | 471681239.015752
 ARGENTINA                 |   1993 | 476672928.508287
 ARGENTINA                 |   1992 |  474966864.08863
 BRAZIL                    |   1998 | 272867200.722561
 BRAZIL                    |   1997 | 476267681.644942
 BRAZIL                    |   1996 | 472833737.263518
 BRAZIL                    |   1995 | 474779532.182009
 BRAZIL                    |   1994 | 470076971.501824
 BRAZIL                    |   1993 |  465856701.12762
 BRAZIL                    |   1992 | 476536342.219503
 CANADA                    |   1998 | 277396081.679339
 CANADA                    |   1997 | 474054167.524568
 CANADA                    |   1996 | 481645684.690841
 CANADA                    |   1995 | 477520920.515102
 CANADA                    |   1994 | 483454035.436825
 CANADA                    |   1993 | 483870426.409778
 CANADA                    |   1992 | 475712164.398604
 CHINA                     |   1998 | 273185165.723116
 CHINA                     |   1997 | 460552724.021887
 CHINA                     |   1996 | 458825526.244701
 CHINA                     |   1995 | 464308827.943164
 CHINA                     |   1994 | 464533426.058576
 CHINA                     |   1993 | 461852982.255813
 CHINA                     |   1992 | 466795342.083104
 EGYPT                     |   1998 | 270668887.161492
 EGYPT                     |   1997 | 466331911.884604
 EGYPT                     |   1996 | 470983201.462077
 EGYPT                     |   1995 | 470924630.612391
 EGYPT                     |   1994 | 467628749.099959
 EGYPT                     |   1993 | 462347441.789644
 EGYPT                     |   1992 | 467867894.514382
 ETHIOPIA                  |   1998 | 272222257.717187
 ETHIOPIA                  |   1997 | 451496153.829521
 ETHIOPIA                  |   1996 | 454486088.056992
 ETHIOPIA                  |   1995 | 456658463.483124
 ETHIOPIA                  |   1994 | 455027378.569836
 ETHIOPIA                  |   1993 |  456370036.25598
 ETHIOPIA                  |   1992 | 453791173.182535
 FRANCE                    |   1998 | 268308891.924204
 FRANCE                    |   1997 | 454378969.602611
 FRANCE                    |   1996 |  461910138.24058
 FRANCE                    |   1995 | 468506295.008509
 FRANCE                    |   1994 | 461991477.493923
 FRANCE                    |   1993 | 460558657.979659
 FRANCE                    |   1992 | 456642285.065459
 GERMANY                   |   1998 | 279512816.289701
 GERMANY                   |   1997 |  479023803.03304
 GERMANY                   |   1996 | 485576674.957633
 GERMANY                   |   1995 | 490296485.402631
 GERMANY                   |   1994 |  478053245.96172
 GERMANY                   |   1993 | 483714354.873037
 GERMANY                   |   1992 | 482188692.752914
 INDIA                     |   1998 | 277286070.311007
 INDIA                     |   1997 | 473386388.605885
 INDIA                     |   1996 | 472484011.290901
 INDIA                     |   1995 | 479276221.622616
 INDIA                     |   1994 | 481868772.065764
 INDIA                     |   1993 |  476245573.42267
 INDIA                     |   1992 | 474986843.759412
 INDONESIA                 |   1998 |  274224798.93413
 INDONESIA                 |   1997 | 464581569.174608
 INDONESIA                 |   1996 | 463558616.711913
 INDONESIA                 |   1995 | 472277740.684826
 INDONESIA                 |   1994 | 461072496.230316
 INDONESIA                 |   1993 | 462862984.693813
 INDONESIA                 |   1992 | 460925648.118769
 IRAN                      |   1998 | 268987038.369045
 IRAN                      |   1997 |  464200080.10857
 IRAN                      |   1996 | 461083243.252309
 IRAN                      |   1995 | 455138137.819849
 IRAN                      |   1994 | 457371766.590151
 IRAN                      |   1993 | 456030093.044638
 IRAN                      |   1992 |  463770285.34953
 IRAQ                      |   1998 | 281627101.817882
 IRAQ                      |   1997 | 477136856.348165
 IRAQ                      |   1996 | 474999671.966287
 IRAQ                      |   1995 | 482694086.511539
 IRAQ                      |   1994 | 479532987.348461
 IRAQ                      |   1993 | 481663509.705595
 IRAQ                      |   1992 | 482330887.804963
 JAPAN                     |   1998 | 277804373.653847
 JAPAN                     |   1997 | 467082892.006281
 JAPAN                     |   1996 | 466570647.235785
 JAPAN                     |   1995 | 472629570.140119
 JAPAN                     |   1994 | 475641905.369631
 JAPAN                     |   1993 | 474723454.049337
 JAPAN                     |   1992 | 473626082.582843
 JORDAN                    |   1998 | 273970599.385639
 JORDAN                    |   1997 |  458042371.76073
 JORDAN                    |   1996 |  468319904.24285
 JORDAN                    |   1995 | 465952209.385158
 JORDAN                    |   1994 | 456533893.004577
 JORDAN                    |   1993 | 466720939.984437
 JORDAN                    |   1992 | 462494364.992747
 KENYA                     |   1998 | 274354092.011695
 KENYA                     |   1997 | 479618395.645733
 KENYA                     |   1996 | 474275853.487178
 KENYA                     |   1995 | 478899558.244471
 KENYA                     |   1994 | 474638941.719777
 KENYA                     |   1993 |  477452607.29259
 KENYA                     |   1992 | 476487460.555986
 MOROCCO                   |   1998 | 276975759.950619
 MOROCCO                   |   1997 |  481967385.68717
 MOROCCO                   |   1996 | 474636831.884261
 MOROCCO                   |   1995 | 480385146.940534
 MOROCCO                   |   1994 | 470935650.313335
 MOROCCO                   |   1993 |  479731960.80359
 MOROCCO                   |   1992 | 477512284.752861
 MOZAMBIQUE                |   1998 | 272925919.735156
 MOZAMBIQUE                |   1997 | 458361149.123514
 MOZAMBIQUE                |   1996 | 461937914.094168
 MOZAMBIQUE                |   1995 | 462065422.475787
 MOZAMBIQUE                |   1994 | 466022123.893664
 MOZAMBIQUE                |   1993 | 458743778.022942
 MOZAMBIQUE                |   1992 |  459676626.26563
 PERU                      |   1998 | 281690469.477866
 PERU                      |   1997 | 462895742.653651
 PERU                      |   1996 | 462040111.151308
 PERU                      |   1995 | 465034681.776234
 PERU                      |   1994 | 457818433.891778
 PERU                      |   1993 | 462712607.007316
 PERU                      |   1992 | 466185739.658511
 ROMANIA                   |   1998 | 270669609.197128
 ROMANIA                   |   1997 | 476625136.483085
 ROMANIA                   |   1996 | 472255056.621333
 ROMANIA                   |   1995 | 470926448.384436
 ROMANIA                   |   1994 | 471331520.218618
 ROMANIA                   |   1993 | 467682897.985923
 ROMANIA                   |   1992 | 469161233.043967
 RUSSIA                    |   1998 | 283800353.993127
 RUSSIA                    |   1997 | 477943810.874536
 RUSSIA                    |   1996 | 482159644.794447
 RUSSIA                    |   1995 |  471115393.44672
 RUSSIA                    |   1994 | 477799739.105718
 RUSSIA                    |   1993 | 480938813.745175
 RUSSIA                    |   1992 | 474701205.188918
 SAUDI ARABIA              |   1998 | 272443181.511795
 SAUDI ARABIA              |   1997 | 464833518.394568
 SAUDI ARABIA              |   1996 |  471959734.06173
 SAUDI ARABIA              |   1995 | 469374647.474013
 SAUDI ARABIA              |   1994 | 466319978.611139
 SAUDI ARABIA              |   1993 | 453564419.965763
 SAUDI ARABIA              |   1992 | 471241712.536259
 UNITED KINGDOM            |   1998 | 270304604.190864
 UNITED KINGDOM            |   1997 | 462045702.839723
 UNITED KINGDOM            |   1996 | 469294673.267887
 UNITED KINGDOM            |   1995 |  466717887.11013
 UNITED KINGDOM            |   1994 | 457430325.919059
 UNITED KINGDOM            |   1993 | 465571699.778789
 UNITED KINGDOM            |   1992 | 464136852.479855
 UNITED STATES             |   1998 | 272374739.357817
 UNITED STATES             |   1997 | 472703982.691263
 UNITED STATES             |   1996 | 469221187.646502
 UNITED STATES             |   1995 | 471023949.739026
 UNITED STATES             |   1994 | 475586913.915488
 UNITED STATES             |   1993 | 471398268.884425
 UNITED STATES             |   1992 | 464028796.135875
 VIETNAM                   |   1998 | 266859703.198977
 VIETNAM                   |   1997 | 460020357.026701
 VIETNAM                   |   1996 | 454371295.591711
 VIETNAM                   |   1995 | 458186602.207179
 VIETNAM                   |   1994 | 453571290.248064
 VIETNAM                   |   1993 | 460313532.000216
 VIETNAM                   |   1992 | 461073964.264787
(175 rows)

COMMIT;
COMMIT
