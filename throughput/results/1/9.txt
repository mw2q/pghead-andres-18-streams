BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 265806586.418068
 ALGERIA                   |   1997 | 455195699.141221
 ALGERIA                   |   1996 | 456714259.971522
 ALGERIA                   |   1995 |  456499954.06564
 ALGERIA                   |   1994 |  451487369.50361
 ALGERIA                   |   1993 | 455591174.783994
 ALGERIA                   |   1992 | 448647686.326282
 ARGENTINA                 |   1998 | 269637869.271183
 ARGENTINA                 |   1997 | 461404743.322789
 ARGENTINA                 |   1996 |  466739633.86431
 ARGENTINA                 |   1995 | 468229814.312176
 ARGENTINA                 |   1994 | 465404791.193265
 ARGENTINA                 |   1993 |  461920148.80641
 ARGENTINA                 |   1992 | 464109956.242134
 BRAZIL                    |   1998 | 274744813.694147
 BRAZIL                    |   1997 | 467021963.598098
 BRAZIL                    |   1996 | 475178986.386844
 BRAZIL                    |   1995 | 464627506.426391
 BRAZIL                    |   1994 | 467506361.913495
 BRAZIL                    |   1993 | 469329623.703933
 BRAZIL                    |   1992 | 472275159.777589
 CANADA                    |   1998 | 267771735.633622
 CANADA                    |   1997 | 468318940.466468
 CANADA                    |   1996 | 474811455.298606
 CANADA                    |   1995 | 465023088.803224
 CANADA                    |   1994 | 472598045.332587
 CANADA                    |   1993 | 470060526.754166
 CANADA                    |   1992 | 461136755.584072
 CHINA                     |   1998 | 274582419.206384
 CHINA                     |   1997 | 460827051.001463
 CHINA                     |   1996 | 462634700.788553
 CHINA                     |   1995 | 461807265.589855
 CHINA                     |   1994 | 463852032.098915
 CHINA                     |   1993 | 457093407.004413
 CHINA                     |   1992 |  464562663.27302
 EGYPT                     |   1998 | 266883760.021654
 EGYPT                     |   1997 | 463840091.457084
 EGYPT                     |   1996 | 460432289.903549
 EGYPT                     |   1995 | 454808233.409565
 EGYPT                     |   1994 | 452809042.715112
 EGYPT                     |   1993 | 461181749.234201
 EGYPT                     |   1992 | 453319629.521595
 ETHIOPIA                  |   1998 | 265028554.508771
 ETHIOPIA                  |   1997 | 446833890.850221
 ETHIOPIA                  |   1996 | 458659979.388674
 ETHIOPIA                  |   1995 | 450473132.049916
 ETHIOPIA                  |   1994 | 456675912.675724
 ETHIOPIA                  |   1993 | 459333785.173113
 ETHIOPIA                  |   1992 | 461892768.983189
 FRANCE                    |   1998 |  270367911.55643
 FRANCE                    |   1997 | 454796740.111619
 FRANCE                    |   1996 | 460670590.432552
 FRANCE                    |   1995 | 451476615.927021
 FRANCE                    |   1994 | 456955115.864468
 FRANCE                    |   1993 | 455858176.676242
 FRANCE                    |   1992 | 457095983.210878
 GERMANY                   |   1998 | 275698481.279548
 GERMANY                   |   1997 | 468552643.135533
 GERMANY                   |   1996 | 473708964.472522
 GERMANY                   |   1995 | 468425343.888706
 GERMANY                   |   1994 | 474184614.038661
 GERMANY                   |   1993 | 480985122.907728
 GERMANY                   |   1992 | 473284216.191263
 INDIA                     |   1998 | 269674627.963803
 INDIA                     |   1997 | 466391560.924893
 INDIA                     |   1996 |  466041586.47434
 INDIA                     |   1995 |  470534932.33968
 INDIA                     |   1994 | 465994106.727156
 INDIA                     |   1993 | 471173821.749679
 INDIA                     |   1992 | 468554959.263155
 INDONESIA                 |   1998 | 269935410.103769
 INDONESIA                 |   1997 | 454233052.842609
 INDONESIA                 |   1996 | 456076318.121984
 INDONESIA                 |   1995 | 454432356.674809
 INDONESIA                 |   1994 | 451974229.696935
 INDONESIA                 |   1993 | 457101806.039678
 INDONESIA                 |   1992 | 462572060.373554
 IRAN                      |   1998 | 275458130.577978
 IRAN                      |   1997 | 469567114.595331
 IRAN                      |   1996 | 471935254.324177
 IRAN                      |   1995 | 468611783.702781
 IRAN                      |   1994 | 464797567.593183
 IRAN                      |   1993 | 465768129.520204
 IRAN                      |   1992 | 469531704.025483
 IRAQ                      |   1998 | 276447302.134476
 IRAQ                      |   1997 | 471284611.170913
 IRAQ                      |   1996 | 485568909.644928
 IRAQ                      |   1995 | 469202394.496991
 IRAQ                      |   1994 | 475057810.464558
 IRAQ                      |   1993 | 477144435.049559
 IRAQ                      |   1992 | 479352482.343811
 JAPAN                     |   1998 | 272361113.488708
 JAPAN                     |   1997 | 467187601.067818
 JAPAN                     |   1996 | 460300958.590586
 JAPAN                     |   1995 | 460905352.748968
 JAPAN                     |   1994 |    462417529.163
 JAPAN                     |   1993 | 467138080.613178
 JAPAN                     |   1992 | 453835197.786351
 JORDAN                    |   1998 | 268266738.583427
 JORDAN                    |   1997 | 444120955.945397
 JORDAN                    |   1996 | 449813115.139387
 JORDAN                    |   1995 | 443569612.710952
 JORDAN                    |   1994 | 458929438.508803
 JORDAN                    |   1993 | 459131691.969013
 JORDAN                    |   1992 | 448934000.967738
 KENYA                     |   1998 |  272741983.11201
 KENYA                     |   1997 | 467085167.862722
 KENYA                     |   1996 | 466107539.696307
 KENYA                     |   1995 | 466863346.396981
 KENYA                     |   1994 | 471057815.165269
 KENYA                     |   1993 | 475116041.503985
 KENYA                     |   1992 | 473657361.870421
 MOROCCO                   |   1998 | 273225767.403264
 MOROCCO                   |   1997 | 461828247.730404
 MOROCCO                   |   1996 | 470643185.870608
 MOROCCO                   |   1995 | 466852525.790596
 MOROCCO                   |   1994 | 464381725.889244
 MOROCCO                   |   1993 | 467657855.567472
 MOROCCO                   |   1992 | 463600110.332448
 MOZAMBIQUE                |   1998 | 270817014.332407
 MOZAMBIQUE                |   1997 |  452525458.14336
 MOZAMBIQUE                |   1996 | 450319772.219735
 MOZAMBIQUE                |   1995 | 457895374.054966
 MOZAMBIQUE                |   1994 |  461418643.23225
 MOZAMBIQUE                |   1993 | 454972129.602989
 MOZAMBIQUE                |   1992 | 457355519.066158
 PERU                      |   1998 | 276382951.659031
 PERU                      |   1997 | 458193183.767724
 PERU                      |   1996 |  463011939.44814
 PERU                      |   1995 | 466463538.995904
 PERU                      |   1994 | 456002091.217902
 PERU                      |   1993 | 462417259.424077
 PERU                      |   1992 | 470109154.146533
 ROMANIA                   |   1998 | 274547839.314173
 ROMANIA                   |   1997 |  459837833.18753
 ROMANIA                   |   1996 | 465148038.712259
 ROMANIA                   |   1995 | 448951017.438823
 ROMANIA                   |   1994 | 457148364.766933
 ROMANIA                   |   1993 | 462435799.024886
 ROMANIA                   |   1992 | 472468771.115174
 RUSSIA                    |   1998 | 270526304.770677
 RUSSIA                    |   1997 | 460762250.387534
 RUSSIA                    |   1996 | 464774455.512787
 RUSSIA                    |   1995 | 462820990.988504
 RUSSIA                    |   1994 |  451317713.35372
 RUSSIA                    |   1993 | 459747674.756211
 RUSSIA                    |   1992 |  471460706.68963
 SAUDI ARABIA              |   1998 | 272887068.079674
 SAUDI ARABIA              |   1997 |  463484351.95467
 SAUDI ARABIA              |   1996 | 460850732.087987
 SAUDI ARABIA              |   1995 | 464900015.293558
 SAUDI ARABIA              |   1994 | 463999421.816896
 SAUDI ARABIA              |   1993 | 457877245.382739
 SAUDI ARABIA              |   1992 | 457570129.821117
 UNITED KINGDOM            |   1998 |  267303287.41152
 UNITED KINGDOM            |   1997 | 462318765.745816
 UNITED KINGDOM            |   1996 | 458840779.130104
 UNITED KINGDOM            |   1995 | 454148917.107088
 UNITED KINGDOM            |   1994 | 463734359.924068
 UNITED KINGDOM            |   1993 | 465939801.423478
 UNITED KINGDOM            |   1992 | 460199566.127897
 UNITED STATES             |   1998 | 271939472.093296
 UNITED STATES             |   1997 |  475054526.84554
 UNITED STATES             |   1996 | 470056193.821511
 UNITED STATES             |   1995 | 469951725.381453
 UNITED STATES             |   1994 | 472961972.810039
 UNITED STATES             |   1993 |  463796002.16551
 UNITED STATES             |   1992 | 470614490.895224
 VIETNAM                   |   1998 | 271821431.344572
 VIETNAM                   |   1997 | 463607856.534225
 VIETNAM                   |   1996 | 472092108.148128
 VIETNAM                   |   1995 |  461181218.07975
 VIETNAM                   |   1994 | 466006308.069658
 VIETNAM                   |   1993 | 470215035.485735
 VIETNAM                   |   1992 | 467451751.557517
(175 rows)

COMMIT;
COMMIT
