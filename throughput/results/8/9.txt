BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%spring%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 261233698.951999
 ALGERIA                   |   1997 | 458132677.071503
 ALGERIA                   |   1996 | 460228527.597506
 ALGERIA                   |   1995 | 469149221.716991
 ALGERIA                   |   1994 | 457934537.913949
 ALGERIA                   |   1993 | 455872716.084424
 ALGERIA                   |   1992 | 459094928.613163
 ARGENTINA                 |   1998 | 278270786.529064
 ARGENTINA                 |   1997 | 469460145.501408
 ARGENTINA                 |   1996 | 479305876.728308
 ARGENTINA                 |   1995 | 475066563.905715
 ARGENTINA                 |   1994 | 473868319.580549
 ARGENTINA                 |   1993 | 473114561.032996
 ARGENTINA                 |   1992 | 479967700.885933
 BRAZIL                    |   1998 | 282297561.510334
 BRAZIL                    |   1997 | 486035527.215279
 BRAZIL                    |   1996 | 475496002.090577
 BRAZIL                    |   1995 | 484992982.174541
 BRAZIL                    |   1994 | 474589720.519424
 BRAZIL                    |   1993 | 471119817.366116
 BRAZIL                    |   1992 | 477504358.532388
 CANADA                    |   1998 | 275780665.918258
 CANADA                    |   1997 | 484329778.274034
 CANADA                    |   1996 | 492275960.460073
 CANADA                    |   1995 |  481638789.91649
 CANADA                    |   1994 | 486339614.270337
 CANADA                    |   1993 | 482269675.887964
 CANADA                    |   1992 | 486075059.300814
 CHINA                     |   1998 | 281378499.670504
 CHINA                     |   1997 | 476345438.912238
 CHINA                     |   1996 | 479802671.537181
 CHINA                     |   1995 | 474031902.903199
 CHINA                     |   1994 | 474106712.552795
 CHINA                     |   1993 | 477097966.709794
 CHINA                     |   1992 | 472245346.366311
 EGYPT                     |   1998 | 273905878.422906
 EGYPT                     |   1997 | 459443928.206371
 EGYPT                     |   1996 | 466844500.870311
 EGYPT                     |   1995 | 471735389.184479
 EGYPT                     |   1994 | 463593258.984157
 EGYPT                     |   1993 | 457657458.771385
 EGYPT                     |   1992 | 460706692.898239
 ETHIOPIA                  |   1998 | 272147562.814516
 ETHIOPIA                  |   1997 | 456808645.435098
 ETHIOPIA                  |   1996 | 450412451.764468
 ETHIOPIA                  |   1995 | 467360512.379109
 ETHIOPIA                  |   1994 | 459274718.187985
 ETHIOPIA                  |   1993 | 466517251.993112
 ETHIOPIA                  |   1992 | 466913417.208498
 FRANCE                    |   1998 | 261663392.892354
 FRANCE                    |   1997 | 458152003.089445
 FRANCE                    |   1996 | 457646901.852799
 FRANCE                    |   1995 | 461163010.080092
 FRANCE                    |   1994 | 461422063.891395
 FRANCE                    |   1993 | 464081161.319365
 FRANCE                    |   1992 | 449588426.783887
 GERMANY                   |   1998 |  277880919.48248
 GERMANY                   |   1997 | 478661970.160151
 GERMANY                   |   1996 |  474328141.70568
 GERMANY                   |   1995 | 484732708.495808
 GERMANY                   |   1994 | 469915581.764285
 GERMANY                   |   1993 | 483701611.762843
 GERMANY                   |   1992 | 482496640.814677
 INDIA                     |   1998 | 274809572.639232
 INDIA                     |   1997 | 477587801.173847
 INDIA                     |   1996 | 485751177.927439
 INDIA                     |   1995 | 489587032.976523
 INDIA                     |   1994 | 475754243.361318
 INDIA                     |   1993 | 481382547.069219
 INDIA                     |   1992 | 482921287.524324
 INDONESIA                 |   1998 | 273623074.125143
 INDONESIA                 |   1997 | 476818885.053908
 INDONESIA                 |   1996 | 475072554.010499
 INDONESIA                 |   1995 | 467781958.014069
 INDONESIA                 |   1994 | 472400092.823976
 INDONESIA                 |   1993 | 475329462.811885
 INDONESIA                 |   1992 | 471764031.378282
 IRAN                      |   1998 | 272647638.571953
 IRAN                      |   1997 | 468180592.906784
 IRAN                      |   1996 | 470121660.200886
 IRAN                      |   1995 | 473218561.229345
 IRAN                      |   1994 | 469558389.377921
 IRAN                      |   1993 | 469295106.846073
 IRAN                      |   1992 |  477028929.73135
 IRAQ                      |   1998 | 278194077.497436
 IRAQ                      |   1997 | 470775772.077955
 IRAQ                      |   1996 | 477384383.316728
 IRAQ                      |   1995 | 481370736.271637
 IRAQ                      |   1994 | 473960027.171192
 IRAQ                      |   1993 |  472036706.04148
 IRAQ                      |   1992 | 471309377.446515
 JAPAN                     |   1998 | 274458464.134975
 JAPAN                     |   1997 | 472530958.181378
 JAPAN                     |   1996 |    463655839.302
 JAPAN                     |   1995 | 474028404.202312
 JAPAN                     |   1994 | 466387111.736951
 JAPAN                     |   1993 | 470344073.298917
 JAPAN                     |   1992 | 469264266.934572
 JORDAN                    |   1998 | 263644087.383076
 JORDAN                    |   1997 |  457909358.96631
 JORDAN                    |   1996 | 463581102.906038
 JORDAN                    |   1995 | 453954989.757988
 JORDAN                    |   1994 | 464223082.099428
 JORDAN                    |   1993 | 452513667.905506
 JORDAN                    |   1992 | 455152553.111032
 KENYA                     |   1998 | 282257876.926428
 KENYA                     |   1997 | 473788507.981969
 KENYA                     |   1996 | 475285588.159643
 KENYA                     |   1995 | 477280600.844601
 KENYA                     |   1994 | 477068995.383339
 KENYA                     |   1993 | 473386811.712195
 KENYA                     |   1992 | 467387533.357056
 MOROCCO                   |   1998 | 282554079.182654
 MOROCCO                   |   1997 | 470632665.639001
 MOROCCO                   |   1996 |  483030096.15192
 MOROCCO                   |   1995 | 464440600.202439
 MOROCCO                   |   1994 | 478782679.607003
 MOROCCO                   |   1993 | 470847794.132697
 MOROCCO                   |   1992 | 468704879.508108
 MOZAMBIQUE                |   1998 | 265682324.353877
 MOZAMBIQUE                |   1997 | 454510175.788188
 MOZAMBIQUE                |   1996 | 466055862.673727
 MOZAMBIQUE                |   1995 | 463816160.803785
 MOZAMBIQUE                |   1994 | 460721977.810498
 MOZAMBIQUE                |   1993 | 461100760.627359
 MOZAMBIQUE                |   1992 | 461235059.209503
 PERU                      |   1998 | 275822748.439309
 PERU                      |   1997 | 466976681.829179
 PERU                      |   1996 | 468708900.091649
 PERU                      |   1995 | 464343473.252744
 PERU                      |   1994 | 466236337.066564
 PERU                      |   1993 | 469088768.434045
 PERU                      |   1992 | 467120627.515805
 ROMANIA                   |   1998 | 276311346.539661
 ROMANIA                   |   1997 | 466706864.567571
 ROMANIA                   |   1996 | 477108758.260705
 ROMANIA                   |   1995 | 469356048.036782
 ROMANIA                   |   1994 | 466318407.870263
 ROMANIA                   |   1993 | 477815362.391184
 ROMANIA                   |   1992 | 475593529.114472
 RUSSIA                    |   1998 | 280136215.253724
 RUSSIA                    |   1997 | 471020562.870884
 RUSSIA                    |   1996 | 477259488.991813
 RUSSIA                    |   1995 |  468781557.90748
 RUSSIA                    |   1994 | 476762222.440051
 RUSSIA                    |   1993 |  482677555.25508
 RUSSIA                    |   1992 | 469718625.214777
 SAUDI ARABIA              |   1998 | 274661563.556752
 SAUDI ARABIA              |   1997 | 474641530.511084
 SAUDI ARABIA              |   1996 | 466227599.190496
 SAUDI ARABIA              |   1995 | 473884278.386649
 SAUDI ARABIA              |   1994 | 458475301.789804
 SAUDI ARABIA              |   1993 | 463791907.969472
 SAUDI ARABIA              |   1992 | 464893596.335959
 UNITED KINGDOM            |   1998 |  267291073.62833
 UNITED KINGDOM            |   1997 | 461344153.159958
 UNITED KINGDOM            |   1996 | 465228434.082323
 UNITED KINGDOM            |   1995 | 462355352.361748
 UNITED KINGDOM            |   1994 | 465830322.565991
 UNITED KINGDOM            |   1993 | 459337873.324978
 UNITED KINGDOM            |   1992 | 466651029.370948
 UNITED STATES             |   1998 | 276160653.087071
 UNITED STATES             |   1997 | 466285957.251795
 UNITED STATES             |   1996 | 470744817.427331
 UNITED STATES             |   1995 | 467016747.686987
 UNITED STATES             |   1994 | 477459643.354725
 UNITED STATES             |   1993 | 474489515.537294
 UNITED STATES             |   1992 | 473076768.403919
 VIETNAM                   |   1998 | 273595749.803634
 VIETNAM                   |   1997 | 467990796.431205
 VIETNAM                   |   1996 | 480153813.597669
 VIETNAM                   |   1995 | 463922217.169406
 VIETNAM                   |   1994 | 465767996.890502
 VIETNAM                   |   1993 | 462338438.439286
 VIETNAM                   |   1992 | 460430074.933769
(175 rows)

COMMIT;
COMMIT
